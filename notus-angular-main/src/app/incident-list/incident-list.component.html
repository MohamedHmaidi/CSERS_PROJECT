<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Incident List</title>

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
</head>
<body class="bg-gray-100 p-8">

<h2 class="text-3xl font-bold mb-8 text-center">Incident List</h2>

<div class="overflow-x-auto">
  <table class="table-auto shadow-md rounded-lg w-full" style="background-color: #F3F4F6;">
    <!-- Table header -->
    <thead class="bg-red-200">
      <tr>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">
          <i class="fas fa-map-marker-alt mr-1"></i> Localisation
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">
          <i class="fas fa-info-circle mr-1"></i> Description
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">
          <i class="fas fa-calendar-alt mr-1"></i> Incident Date
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">
          <i class="fas fa-info-circle mr-1"></i> Status
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">
          <i class="fas fa-user mr-1"></i> User
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">
          <i class="fas fa-exclamation-triangle mr-1"></i> Type Incident
        </th>
        <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">Actions</th>
      </tr>
    </thead>
    <!-- Table body -->
    <tbody>
      <tr *ngFor="let i of incidents.slice(paginationStart, paginationEnd)" class="hover:bg-gray-100">
        <td class="border px-6 py-4 whitespace-nowrap">{{ i.localisation }}</td>
        <td class="border px-6 py-4 whitespace-nowrap">{{ i.description }}</td>
        <td class="border px-6 py-4 whitespace-nowrap">{{ i.incidentDate | date: 'medium' }}</td>
        <td class="border px-6 py-4 whitespace-nowrap">
          <span class="inline-block rounded-full px-2 py-1 text-sm font-semibold text-white {{ i.status === 'IN_PROGRESS' ? 'bg-yellow-500' : 'bg-blue-500' }}">
            <i class="fas fa-circle mr-1"></i>{{ i.status === 'IN_PROGRESS' ? 'IN PROGRESS' : i.status }}
          </span>
        </td>
        <td class="border px-6 py-4 whitespace-nowrap">{{ i.user.firstname }} {{ i.user.lastname }}</td>
        <td class="border px-6 py-4 whitespace-nowrap">{{ i.typeIncident.nomTypeIncident }}</td>
        <td class="border px-6 py-4 whitespace-nowrap">
          <button (click)="UpdateIncident(i.idIncident)" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mr-2">
            <i class="fas fa-pencil-alt mr-1"></i> Update
          </button>
          <button class="bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" (click)="deleteIncident(i.idIncident)">
            <i class="fas fa-trash mr-1"></i> Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="flex justify-end mt-4">
  <div>
    <button [disabled]="currentPage === 1" (click)="onPageChange(currentPage - 1)"
            class="px-3 py-1 rounded border mr-2 hover:bg-gray-200">
      <i class="fas fa-chevron-left"></i>
    </button>
    <span class="px-3 py-1 border rounded mr-2">{{ currentPage }} / {{ totalPages }}</span>
    <button [disabled]="currentPage * pageSize >= incidents.length" (click)="onPageChange(currentPage + 1)"
            class="px-3 py-1 rounded border hover:bg-gray-200">
      <i class="fas fa-chevron-right"></i>
    </button>
  </div>
</div>


<button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded absolute top-4 right-4" (click)="navigateToTypeIncidents()">
  <i class="fas fa-arrow-right mr-1"></i> All Incident Types
</button>

</body>
</html>
